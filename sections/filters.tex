%! TeX root: ../main.tex
\section{Filters and Ultrafilters}
In this short section, we introduce a sequence of lemmas building up to Lemma \ref{filter:3}, which is fundamental to the proof of the main result. We start with some elementary examples of filters and ultrafilters, and we conclude with Lemma \ref{filter:4}, which is yet another elegant application of Lemma \ref{filter:3}. The development of these lemmas is due to the theory covered in the notes of Koppelberg \cite{notes:2011} and the work of Brian \cite{brian:2016}.

Recall from the introduction that a \emph{filter} \( \mathcal{F} \) on \( X \) is a family of subsets of \( X \) with \( \emptyset \notin \mathcal{F} \), \( X \in \mathcal{F} \), and which is closed under the superset inclusion and finite intersections. A filter \( \mathcal{F} \) is an \emph{ultrafilter} if no filter properly contains it, and we call \( \mathcal{F} \) \emph{free} if \( \medcap \mathcal{F} = \emptyset \). 

It turns out that one needs the axiom of choice to prove that free ultrafilters exist in \( \mathbb{N} \). Likewise, Zorn's lemma is required to prove that every filter is contained in an ultrafilter. For a more in-depth treatment, the interested reader is encouraged to see Section 3 in \cite{notes:2018}.

We briefly look at some simple examples of filters and ultrafilters as presented in \cite{notes:2011}. Then, we will move on to the proof of Lemma \ref{filter:1}.


\begin{itemize}[leftmargin=0.8cm]
\item For a non-empty subset \( A \subseteq \mathbb{N} \), the family \( \mathcal{F} = \{ B \subseteq \mathbb{N} : A \subseteq B \} \) is a filter. Note that \( \mathcal{F} \) is not free since each set in \( \mathcal{F} \) contains \( A \). If \( A \) is a singleton, then \( \mathcal{F} \) is an ultrafilter \cite{notes:2018}.
\item A subset \( A \subseteq \mathbb{N} \) is called \emph{cofinite} if \( \mathbb{N} \setminus A \) is finite. The collection of cofinite subsets of \( \mathbb{N} \) is a filter, called the Fr\'echet filter. The Fr\'echet filter is not an ultrafilter, but it is free since \( \mathbb{N} \setminus \{ m \} \) is cofinite for every integer \( m \in \mathbb{N} \). In fact, a filter is free if and only if it contains the Fr\'echet filter (see Proposition 2 in \cite{notes:2015}).
\item For a topological space \( X \) and a point \( x \in X \), we call a set \( N \subseteq X \) a \emph{neighbourhood} of \( x \) if there is an open subset of \( N \) containing \( x \). Then the family \( \mathcal{U}(x) \) of all neighbourhoods of \( x \) is a filter, and \( \mathcal{U}(x) \) is an ultrafilter if and only if \( \{ x \} \) is open in \( X \).
\end{itemize}

With these examples covered, we are ready for our first lemma.

\begin{lemma}
\label{filter:1}
If \( \mathcal{A} \) is a non-empty family of non-empty subsets of \( X \) such that any finite intersection of sets in \( \mathcal{A} \) is non-empty, then there is a filter \( \mathcal{F} \) which contains \( \mathcal{A} \).
\end{lemma}
\begin{proof}
First let \( \mathcal{F}' = \mathcal{A} \cup \mathcal{I} \), where \( \mathcal{I} \) is the set of all finite intersections of sets in \( \mathcal{A} \). Then \( \mathcal{F'} \) is closed under finite intersections. Then let \( \mathcal{F} = \mathcal{F}' \cup \mathcal{S} \), where \( A \in \mathcal{S} \) if and only if \( A \) contains a set in \( \mathcal{F}' \).

We first note that \( \emptyset \notin \mathcal{F} \) since the intersection of any finite sub-collection of \(\mathcal{A} \) is non-empty. Likewise, \( X \in \mathcal{F} \) by the non-emptyness of \( \mathcal{A} \) and the construction of \( \mathcal{S} \). Clearly \( \mathcal{F} \) is closed under the superset inclusion. It remains to show that if \( A, B \in \mathcal{F} \) then \( A \cap B \in \mathcal{F} \). 

If \( A, B \in \mathcal{F} \), the only non-trivial case needing consideration is, without loss of generality, when \( A \in \mathcal{S} \). So there are sets \( A', B' \in \mathcal{F}' \) with \( A' \subseteq A \) and \( B' \subseteq B \) (if \( B \in \mathcal{F}' \) then \( B' = B \)). Since \( \mathcal{F} ' \) is closed under finite intersections, \( A' \cap B' \in \mathcal{F} ' \). Then, from \( A' \cap B' \subseteq A \cap B \) it follows that \( A \cap B \in \mathcal{S} \subseteq \mathcal{F} \). Hence \( \mathcal{F} \) is closed under finite intersections, as needed.
\end{proof}
\begin{lemma}
\label{filter:2}
A filter \( \mathcal{F} \) is an ultrafilter if and only if for every subset \( A \subseteq X \) either \( A \in \mathcal{F} \) or \( A^{c} \in \mathcal{F} \).
\end{lemma}
\begin{proof}
For ``$\Rightarrow$'', let \( \mathcal{F} \) be an ultrafilter and suppose for a contradiction that there is a subset \( A \subseteq X \) with \( A \notin \mathcal{F} \) and \( A^{c} \notin \mathcal{F} \). So every set in \( \mathcal{F} \) intersects both \( A \) and \( A^{c} \). Using this and the fact that \( \mathcal{F} \) is a filter, it follows that any finite sub-collection of \( \mathcal{F} \cup \{ A \} \) has a non-empty intersection. Then, Lemma \ref{filter:1} implies that there is a filter containing \( \mathcal{F} \cup \{ A \} \), and so \( \mathcal{F} \) is properly contained in a filter, a contradiction.

For ``\(\Leftarrow\)", suppose \( \mathcal{F} \) is a filter with the property that \( A \in \mathcal{F} \) or \( A^{c} \in \mathcal{F} \) for every subset \( A \subseteq X \). If \( \mathcal{F} \) is not an ultrafilter then there is another filter \( \mathcal{F} ' \) which properly contains \( \mathcal{F} \). Hence there is a subset \( E \subseteq X \) with \( E \in \mathcal{F} ' \) and \( E \notin \mathcal{F} \). Thus \( E^{c} \in \mathcal{F} \) and hence \( E^{c} \in \mathcal{F} ' \). But then \( \mathcal{F} ' \) contains the empty set since it is closed under finite intersections and \( \emptyset = E \cap E^{c} \in \mathcal{F} ' \), which is a contradiction.
\end{proof}
We will say that a filter \( \mathcal{F} \) has the \emph{Ramsey property} if whenever \( \medcup_{j=1}^{n} A_{j} \in \mathcal{F} \) there is a \( j \in [n] \) with \( A_{j} \in \mathcal{F} \). In this connection, we have the following surprising result.
\begin{lemma}
\label{filter:3}
A filter \( \mathcal{F} \) is an ultrafilter if and only if \( \mathcal{F} \) has the Ramsey property.
\end{lemma}
\begin{proof}
It suffices to prove the claim for \( n = 2 \). Let \( \mathcal{F} \) be an ultrafilter and suppose for a contradiction that \( A = A_1 \cup A_2 \) is in \( \mathcal{F}\) but \( A_1 \notin \mathcal{F} \) and \( A_2 \notin \mathcal{F} \). From Lemma \ref{filter:2}, we have \( A_1^{c} \in \mathcal{F} \) and \( A_2^{c} \in \mathcal{F} \) so that \( A^{c} = A_1^{c} \cap A_2^{c} \in \mathcal{F} \). Consequently, \( \emptyset = A \cap A^{c} \in \mathcal{F} \) is a contradiction. 

Conversely, assume \( \mathcal{F} \) has the Ramsey property. If \( \mathcal{F} \) is not an ultrafilter, then Lemma \ref{filter:2} asserts that there is a subset \( A \subseteq X \) with \( A \notin \mathcal{F} \) and \( A^{c} \notin \mathcal{F} \). But \(X \in \mathcal{F} \) and \( X = A \cup A^{c} \), so we must have \( A \in \mathcal{F} \) or \( A^{c} \in \mathcal{F} \), contradicting our choice of \( A \).
\end{proof}

For a family \( \mathcal{F} \) of subsets of \( X \), we define its \emph{dual} \( \mathcal{F} ^{\ast} \) to be the collection of all subsets of \( X \) which intersect every set in \( \mathcal{F} \).

A simple example of families and their duals is as follows \cite{brian:2016}. We call a subset \( A \subseteq \mathbb{N} \) \emph{thick} if it contains intervals of arbitrary lengths, and we call \( A \) \emph{syndetic} if the space between its intervals is bounded. That is, \( A \) is syndetic if there is an integer \( N \in \mathbb{N} \) such that every interval of length \( N \) contains a point in \( A \). Then, the dual of the family of syndetic subsets of \( \mathbb{N} \) is the class of thick sets in \( \mathbb{N} \).

The following result, due to Glasner, relates ultrafilters to their duals \cite{glasner:1980}. We provide its proof here for clarity.

\begin{lemma}
\label{filter:4}
A filter \( \mathcal{F} \) is an ultrafilter if and only if \( \mathcal{F} ^{\ast} \) is a filter.
\end{lemma}
\begin{proof}
For ``$\Rightarrow$", assume that \( \mathcal{F} \) is an ultrafilter, and fix \( A,B \in \mathcal{F} ^{\ast} \). To prove that \( A \cap B \in \mathcal{F} ^{\ast} \), it suffices to fix a set \( E \in \mathcal{F} \) and prove that \( E \) intersects \( A \cap B \). Note that since \( A \in \mathcal{F} ^{\ast} \) we have \( E \cap A \neq \emptyset \). Hence we may write \[ E = (E \cap A) \cup (E \setminus A). \] Certainly \( E \setminus A \notin \mathcal{F} \), as otherwise \( A \in \mathcal{F} ^{\ast} \) implies \( (E\setminus A) \cap A \neq \emptyset \). Since \( \mathcal{F} \) is an ultrafilter, Lemma \ref{filter:3} implies that \( \mathcal{F} \) has the Ramsey property so that \( E \cap A \in \mathcal{F} \). Since \( B \in \mathcal{F} ^{\ast} \), it follows as needed that \( E \cap (A \cap B) \neq \emptyset \).

Conversely, for ``$\Leftarrow$", let \( \mathcal{F} ^{\ast} \) be a filter. Suppose for a contradiction that \( \mathcal{F} \) is not an ultrafilter. Then Lemma \ref{filter:2} implies that there is a subset \( A \subseteq X \) with \( A \notin \mathcal{F} \) and \( A^{c} \notin \mathcal{F} \). Thus, every set in \( \mathcal{F} \) intersects both \( A \) and \( A^{c} \). That is, for every \( B \in \mathcal{F} \) we have \( A \cap B \neq \emptyset \) and \( A^{c} \cap B \neq \emptyset \). By definition, then, \( A \in \mathcal{F}^{\ast} \) and \( A^{c} \in \mathcal{F} ^{\ast} \). But \( \mathcal{F} ^{\ast} \) is a filter, so \( \emptyset = A \cap A^{c} \in \mathcal{F} ^{\ast} \) is a contradiction, and the proof is complete.
\end{proof}
